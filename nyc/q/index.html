<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenDebateQuestions.com | NYC Mayor</title>
    <meta property="og:image" content="https://s3.amazonaws.com/s3.boldprogressives.org/images/ma-5-fb-share-v2.jpg" />
    <link rel="canonical" href="http://opendebatequestions.com/nyc/" />
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,300,600,400|Open+Sans+Condensed:700" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="http://s3.amazonaws.com/s3.boldprogressives.org/wp-content/themes/premise/style.css.gzip" />
    <link rel="stylesheet" type="text/css" media="screen" href="/nyc/rfo.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/nyc/header-footer.css" />



<!--[if !IE]><!--><script> if (/*@cc_on!@*/false) { document.documentElement.className+=' ie10'; } </script><!--<![endif]-->

</head>
<body>	

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

	<div id="overlay" style="display:none">&nbsp;</div>   
<div id="page_content">
    
    <header>
    	<div class="breaker cf nav">
    	<div class="width-align">
    		<!--ul class="pull-left">
	    		<li><a href="/nyc/">OpenDebateQuestions.com</a></li>
    		</ul-->
	    	<ul class="pull-right">
<!-- -->	   <li><a href="/nyc/">Home</a></li> <!-- -->
	    		<li><a href="/nyc/candidates/">Candidates</a></li>
				<li><a href="/nyc/about/">About</a></li>
			        <li><a href="/ma5/">Past Debates</a></li>
				<li><a href="/nyc/q/">Participate</a></li>
	    	</ul>
    	</div>
    	</div>
    	<div class="breaker cf logos">
    	<div class="width-align">
    	  <a href="/nyc/"><img src="https://s3.amazonaws.com/s3.boldprogressives.org/images/ODQ-NYC-logo.jpg" /></a>
    	  <a href="/nyc/contact/"><img src="https://s3.amazonaws.com/s3.boldprogressives.org/images/ODQ-host-btn.jpg" class="pull-right hidden-phone" /></a>
    	</div>
    	</div>
    </header>


<link rel="stylesheet" type="text/css" media="screen" href="lightbox.css" />
<link rel="stylesheet" type="text/css" media="screen" href="debate.css" />
<style type="text/css">
.breaker.content {background-color: #e3e3e3; border-top: 1px solid rgb(160,160,160); padding-top: 20px; padding-bottom: 40px; }
.card { 
  background-color: white; 
  border: 0 !important; 
  -moz-box-shadow:    0px 0px 1px 1px #aaa !important;
  -webkit-box-shadow: 0px 0px 1px 1px #aaa !important;
  box-shadow:         0px 0px 1px 1px #aaa !important;
}
.nav_card {
  padding-bottom: 0;
  margin-bottom: 20px;
}
.vote-bottom { font-size: 12px; font-weight: 600; }

a.take-action.red{
	background: #d9000d;
}
a.take-action.red:hover { background-color: rgba(234, 24, 34, .9); }
</style>

<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.2/leaflet.css" />
<!--[if lte IE 8]>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.2/leaflet.ie.css" />
    <![endif]-->
<link rel="stylesheet" href="leaflet.markercluster/MarkerCluster.css" />
<link rel="stylesheet" href="leaflet.markercluster/MarkerCluster.Default.css" />
<!--[if lte IE 8]><link rel="stylesheet" href="leaflet.markercluster/MarkerCluster.Default.ie.css" /><![endif]-->

  <div class="lightbox share_after_question" style="display:none">
    <div class="close_box">X</div>
    <h2 style="font-size: 22px">Thanks for your submission</h2>
    Make sure your questions gets the most votes by sharing with your friends!
    
    <a class="take-action lightblue nocase facebookshare">Share on Facebook</a>
    <a class="take-action lightblue nocase twittershare">Post to Twitter</a>
    <div><a style="font-size: 12px; color: white" 
            onclick="$('.share_after_question').fadeOut(); $('#overlay').fadeOut(); return false;"
            href="#">No thanks. I am not exactly the sharing type.</a>
    </div>
  </div>

  <div class="lightbox out_of_area" style="display:none">
    <div class="close_box">X</div>
    <h2 style="font-size: 22px">Sorry!  Massachusetts only.</h2>
    Sorry, we're currently only allowing Massachusetts residents to vote for the questions they want in the debate.  But feel free to submit your own question for voting, and share with your friends in Massachusetts!
  </div>
  <div class="lightbox donate" style="display: none; width: 400px">
    <div class="close_box">X</div>
    <hr class="checkbox_icon" />
    <h2 style="font-size: 28px">Thank you for your votes!</h2>
    <div style="font-size: 14px">Can you help support more people-powered debates by donating to this project?</div>
    <a class="take-action" target="_blank" style="font-size: 18px" 
       onclick="$('.donate').fadeOut(); $('#overlay').fadeOut(); return true;"
       href="https://secure.actblue.com/contribute/page/ma5debate?refcode=ma5debate-3v">Yes, I'll Donate</a>
    <div><a style="font-size: 12px; color: white" 
            onclick="$('.donate').fadeOut(); $('#overlay').fadeOut(); return false;"
            href="#">No thanks.</a></div>
  </div>
  <div class="lightbox already_voted" style="display:none">
    <div class="close_box">X</div>
    <h2 style="font-size: 22px">You've already voted for this question!</h2>
    You can only vote once per question.  You can still cast a vote for any other questions, and make sure to tell your friends to vote for this question too!
  </div>

  <div style="display:none; left: 35%" class="lightbox" id="vote_form_lightbox">
  <div class="close_box">X</div>
    	<hr class="mic_icon"/>
    	<h2>Sign Up &ndash; Be Heard</h2>
    	<div id="verify_location_error" class="error_msg" style="display:none">
		<p class="empty_input" style="display:none">Please fill all fields before submitting. </p>
    	
    	<p class="invalid_vote_email" style="display:none">Please enter a valid email address.</p>
    	<p class="invalid_vote_zip" style="display:none">Please enter a valid zipcode.</p>

    	</div>

	    <form id="vote_form">
    	<p><input type="email" id="vote_email" placeholder="Email"/></p>
    	<p><input type="text" id="vote_zip" placeholder="Zip" /></p>
    	<button class="take-action" type="submit">Vote!</button>
    	</form>

<div><a style="font-size: 12px; color: white" href="/nyc/about/#how_it_works">(Find out how we use this information)</a></div>
    	
    </div>


	<div id="overlay" style="display:none">&nbsp;</div>   
<div id="page_content">
<div class="breaker content cf">
  <div class="width-align">
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=1390830227802266";
      fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script>
    <script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
       
<div class=" content cf">
	<div class="span66">
		<span id="recognized_user"></span>
	</div>
	<div class="span33 pull-right">
        <a style="text-decoration: none;" href="/nyc/contact/">Having trouble with the site? Tell us about it here.</a>
	</div>
</div>    

    <div class="span66">
      <div class="cf card nav_card">
        <div id="nav">
          <div class="width-align">
            <h3 style="display: inline-block; vertical-align: center"
                class="search_label"><a style="font-size: 16px"
                                        name="search">Search for a topic</a></h3>
            <form style="vertical-align: center; display: inline-block; 
                         margin-left: 0.8em; width: 60%"
                  onsubmit="return false;" style="text-align: center">
              <input type="text" id="search" 
                     style="vertical-align: center; width: 100%"
                     placeholder="Search current questions"
                     onkeyup="var text=$(this).val().trim(); if( text && text.length >= 4 ) { opendebate.search(text); } return false;" />
            </form>
          </div>
          <span style="display: inline-block; width: auto">Show:</span>
          <span style="text-align: center; display: inline-block; width: 80%">
          <a data-sort="recent_votes" onclick="$('#search').val(''); opendebate.clearSearch();" href="#/sort/recent_votes/p1/">Trending</a>
          &sdot;
          <a data-sort="date" onclick="$('#search').val(''); opendebate.clearSearch();" href="#/sort/date/p1/">Newest</a>
          &sdot;
          <a data-sort="votes" onclick="$('#search').val(''); opendebate.clearSearch();" href="#/sort/votes/p1/">Popular</a>
          &sdot;
          <a data-sort="random" onclick="$('#search').val(''); opendebate.clearSearch();" href="#/sort/random/p1/">Random</a>
          &sdot;
          <a data-sort="map" onclick="$('#search').val(''); opendebate.clearSearch();" href="#/location/">Map</a>
          <span class="add_question_header_link">&sdot;
            <a href="#add_question">Submit a Question</a>
          </span>
          </span>
        </div>
      </div>
     <div id="map" style="display: none; height: 400px;"></div>
    <div id="container" >
    
    
    
    
    </div>
    </div>

<!--div class="sidecar pull-right">
      
</div-->

    <div class="reminder_well submit_question"
         onclick="$(this).hide(); $('.form-well.category-well').slideDown(); return false;"
         style="clear: right; float: right; width: 34%">
      <a target="_blank"
         href="#add_question" style="display: block; width: 100%; background-color: #006ea9;
                                       margin: 0 0 10px 0; padding-right: 0; padding-left: 0"
         class="take-action">Browse by Issue</a>	
    </div>
    <div style="display: none" class="span33 form-well category-well" style="clear: right">
      <h2>Topics</h2>
      <div style="word-wrap: break-word; max-height: 400px; overflow-y: scroll"></div>
    </div>

    <div class="reminder_well submit_question"
         onclick="$(this).hide(); $('.form-well.question-well').slideDown(); return false;"
         style="clear: right; float: right; width: 34%">
      <a target="_blank"
         href="#add_question" style="display: block; width: 100%; background-color: #006ea9;
                                       margin: 0 0 10px 0; padding-right: 0; padding-left: 0"
         class="take-action">Submit a New Question</a>	
    </div>

    <div style="display: none; clear: right" class="span33 form-well question-well">
      

		
        <div id="add_question" name="add_question">
        
    	<h2>Submit a new Question</h2>
    	<hr class="mic_icon"/>    	
    	<div id="thanks" style="display:none"></div>
    	
    	<div id="add_question_error" class="error_msg" style="display:none"><p class="empty_input" style="display:none">Please fill all fields before submitting. </p>
    	
    	<p class="invalid_email" style="display:none">Please enter a valid email address.</p>
    	<p class="invalid_zip" style="display:none">Please enter a valid zipcode.</p>
    	
    	</div>
    	
    	<form id="new_question" name="new_question" onsubmit="opendebate.submitQuestion(); return false;">
	  <textarea class="required" name="question" id="new_question_text" rows="4" placeholder="Enter your question here.  If you have multiple questions, please submit each one separately."></textarea>
          <div class="count" style="float: right; margin-right: 9px; display: none">
            (<span class="count">200</span> / 200)
          </div>

          <select id="category" style="padding-top: 3px; width: 95%" name="category" 
                  class="required">
            <option class="fixed" value="">Select a category</option>

            <option class="fixed last" value="_other">other category</option>
          </select>
          <input style="display: none" id="other_category" type="text"
                 name="other_category" placeholder="add your category" />
          <hr />

	  <input class="user required" type="text" name="first_name" id="first_name"  placeholder="First Name"/>    	
	  <input class="user required" type="text" name="last_name" id="last_name"  placeholder="Last Name"/>
	  <input class="user required" type="email" name="email" id="email"  placeholder="Email"/>
	  <input class="user required" type="text" name="zip" id="zip"  placeholder="Zipcode"/>
	  <button type="submit" class="take-action">Add Your Question</button>
   
    	</form>
    	   
    </div>
    
    </div>

        <div class="reminder_well" style="clear: right; float: right; width: 34%">
          <a target="_blank"
             href="/nyc/reminders/" style="display: block; width: 100%; background-color: #006ea9;
                                           margin: 0; padding-right: 0; padding-left: 0"
             class="take-action">sign up for a reminder</a>	
        </div>


    <div class="activity_well" style="margin-top: 20px; margin-bottom: 10px; clear: right; float: right; width: 34%">
      <h2 style="font-family: 'Open Sans', helvetica, arial, sans-serif; color: #000; font-weight: 400; font-size: 18px; margin-bottom: 8px; padding-bottom: 3px;
                 text-transform: uppercase; border-bottom: 1px solid black">
        Recent Activity</h2>
      <div id="activity_entries">Loading...</div>
    </div>

    
  </div>
</div>


<footer>
    	<div class="breaker cf nav">
    	<div class="width-align">
	    	<ul class="cf">
	    		<li><a href="/nyc/">Home</a></li>
	    		<li><a href="/nyc/candidates/">Candidates</a></li>
				<li><a href="/nyc/about/">About</a></li>
				<li><a href="/nyc/q/">Participate</a></li>
				<li><a href="/nyc/contact/">Contact</a></li>
				<li><a href="/nyc/privacy/">Privacy Policy</a></li>				
			        <li><a href="/ma5/">Past Debates</a></li>
				<li><a href="https://secure.actblue.com/contribute/page/ma5debate?refcode=nyc-opendebate-footer">Donate to our work</a></li>
	    	</ul>
    	</div>
    	</div>
    	
    	
        <div class="breaker cf blurb">
        	<div class="width-align"><center>
                <div class="disclaimer">
                    <p>Paid for by the Progressive Change Campaign Committee PAC (BoldProgressives.org) and not authorized by any candidate or candidate's <br /> 
                    committee. Contributions to the PCCC are not deductible as charitable contributions for federal income tax purposes.</p>
                </div>
        	</center></div>
        </div>
</footer>


    </div><!-- headslide-wrap -->
</div>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="/nyc/jquery.cookie.js"></script>
  <script src="/nyc/q/jquery.tagcloud.js"></script>
  <script type="text/javascript">
      window.getArgs = function() {
	    var argsStr = window.location.search;
	    var pairs = argsStr.replace(/^\?/, '').split('&');
	    var args = {};
	    unesc = unescape;
	    if ( typeof(decodeURIComponent) != 'undefined' )
	    	unesc = decodeURIComponent;
	    for ( var i = 0; i < pairs.length; ++i ) {
		    pair = pairs[i].split('=');
		    if (pair[0]) {
			    if (pair[1])
			    	pair[1] = unesc(pair[1].replace(/\+/g, ' '));
			    args[unesc(pair[0].replace(/\+/g, ' '))] = pair[1];
			}
		}
		return args;
      };

    $("#new_question_text").on("focusout", function() {
      $("#category_warning").fadeOut().remove();
      var cats = $(".category-well a:not(.fixed)").map(function() { 
        return $(this).text(); });
      var val = $(this).val();
      for( var i=0; i<cats.length; ++i ) {
        var match = val.match(new RegExp(cats[i], "gi")); 
        if( match ) {
          var count = parseInt($(".category-well a[data-category=" + cats[i] + "]").attr("rel"));
          if( count ) {  
            $("<div>").attr("id", "category_warning").html("<br/>Psst -- we already have " + count + " question" + (count === 1 ? " " : "s ") + "about " + cats[i] + "!<br/><a style='color: white; font-weight: bold' href='#/category/" + cats[i] + "/'>You can browse through them all here</a>.<br/><br/>If one of them is similar to the question you'd like to ask, please vote for it and share it with your friends instead of submitting a new question!<br/><br/>").css("display", "none").insertBefore("#category").slideDown();
            break;
          }
        }
      }
    });                                 
    
    $(window).load(function() {

      var akid = getArgs().akid;
      if( akid ) {
        $.cookie("pccc.akid", akid, {expires: 7, path: "/"});
      } 
      var source = getArgs().source;
      if( source ) {
        $.cookie("pccc.source", source, {expires: 1, path: "/"});
      } 

$(function() {
    function m(n, d) {
        P = Math.pow;
        R = Math.round
        d = P(10, d);
        i = 7;
        while(i) {
            (s = P(10, i-- * 3)) <= n && (n = R(n * d / s) / d + "KMGTPE"[i])
        }
        return n;
    }

$(function() {
    $.ajax({
        url: 'https://twitter.com/users/BoldProgressive.json?callback=?',
        data: {
        },
        dataType: 'json',
        success: function(data) {
            $('#followers').html(m(data.followers_count, 1));
        }
    });
});
});
    });
  </script>
  <script src="http://s3.amazonaws.com/s3.boldprogressives.org/wp-content/themes/premise/js/bootstrap.js.gzip"></script>

<script type="text/javascript" src="http://s3.amazonaws.com/s3.boldprogressives.org/wp-content/themes/premise/ak/jquery.embedly.min.js"></script>
<script type="text/javascript">
  validators = {};
  validators.email = function(value) {
    if ( !/^\s*\S+@\S+\.\S+\s*$/.test(value) )
        return false
    return true;
  };

  validators.zip = function(value) {
    if ( !/\d{5}/.test(value) )
        return false;
    return true;
  };	  
  var validate = function() {
    var valid = true;
    var val = $("#actionkit-signup-form input[name=email]").val();
    if( !val || !validators.email(val) ) {
      $("#actionkit-signup-form input[name=email]").css("background-color", "pink");
      valid = false;
    } else {
      $("#actionkit-signup-form input[name=email]").css("background-color", "white");
    }
    var val = $("#actionkit-signup-form input[name=zip]").val();
    if( !val || !validators.zip(val) ) {
      $("#actionkit-signup-form input[name=zip]").css("background-color", "pink");
      valid = false;
    } else {
      $("#actionkit-signup-form input[name=zip]").css("background-color", "white");
    }
    if( !valid ) return false;
  };
  $("#actionkit-signup-form").on("submit", validate);
  $("#actionkit-signup-form input[type=submit]").on("click", validate);

  window.formatDate = function(datestring) {

  var zeroPadded = function(n) {
    return n < 10 ? "0" + n : "" + n;
  };
	     
	     var last_updated = new Date(datestring) // e.g. "Feb. 13, 2013, 03:39:14 AM", assumed to be UTC
	     last_updated.setMinutes(last_updated.getMinutes() - last_updated.getTimezoneOffset());
	     var months = ["Jan.", "Feb.", "Mar.", "Apr.", "May", "Jun.",
	     "Jul.", "Aug.", "Sep.", "Oct.", "Nov.", "Dec."];
	     last_updated = months[last_updated.getMonth()] + " " + last_updated.getDate()
	     + ", " + (last_updated.getYear() + 1900) + ", "
	     + (last_updated.getHours() > 12 ? last_updated.getHours() - 12 : last_updated.getHours()) 
    + ":" + zeroPadded(last_updated.getMinutes())
    + (last_updated.getHours() > 11 ? " PM" : " AM");
    return last_updated;
    }
    $("span.time a").each(function() { 
      var gmt = $(this).text();
      var localeTime = formatDate(gmt);
      $(this).attr("title", localeTime).text(humaneDate(localeTime) || localeTime);
    });
</script>

  <script type="text/javascript">
// instead of including all of http://act.boldprogressives.org/resources/actionkit.js
// just using the getArgs function
    getArgs = function() {
	    var argsStr = window.location.search;
	    var pairs = argsStr.replace(/^\?/, '').split('&');
	    var args = {};
	    unesc = unescape;
	    if ( typeof(decodeURIComponent) != 'undefined' )
	    	unesc = decodeURIComponent;
	    for ( var i = 0; i < pairs.length; ++i ) {
		    pair = pairs[i].split('=');
		    if (pair[0]) {
			    if (pair[1])
			    	pair[1] = unesc(pair[1].replace(/\+/g, ' '));
			    args[unesc(pair[0].replace(/\+/g, ' '))] = pair[1];
			}
		}
		return args;
	} 
	window.pccc = {}, window.pccc.args = getArgs();
	$(function() {   
		$("form").append('<input type="hidden" name="source" value="'+window.pccc.args.source+'" />')
	  	         .append('<input type="hidden" name="action_referrer" value="' + document.referrer + '" />');
	});
	// actionkit.forms.contextRoot = '//act.boldprogressives.org/context/';
	// actionkit.forms.initForm('candidate');
	// actionkit.utils.appendHiddenInput('action_referrer', document.referrer);
	</script>

	<!-- Google Code for Remarketing Tag -->
	<!--------------------------------------------------
	Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup
	--------------------------------------------------->
	<script type="text/javascript">
	/* <![CDATA[ */
	var google_conversion_id = 1035744392;
	var google_custom_params = window.google_tag_params;
	var google_remarketing_only = true;
	/* ]]> */
	</script>
	<script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
	</script>
	<noscript>
	<div style="display:inline;">
	<img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1035744392/?value=0&amp;guid=ON&amp;script=0"/>
	</div>
	</noscript>	

    <script>
      window.getArgs = function() {
	    var argsStr = window.location.search;
	    var pairs = argsStr.replace(/^\?/, '').split('&');
	    var args = {};
	    unesc = unescape;
	    if ( typeof(decodeURIComponent) != 'undefined' )
	    	unesc = decodeURIComponent;
	    for ( var i = 0; i < pairs.length; ++i ) {
		    pair = pairs[i].split('=');
		    if (pair[0]) {
			    if (pair[1])
			    	pair[1] = unesc(pair[1].replace(/\+/g, ' '));
			    args[unesc(pair[0].replace(/\+/g, ' '))] = pair[1];
			}
		}
		return args;
      };

      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-6874881-6', 'opendebatequestions.com');
    </script>

        
    <script src="http://cdn.leafletjs.com/leaflet-0.6.2/leaflet.js"></script>
    <script src="leaflet.markercluster/leaflet.markercluster.js"></script>
    <script type="text/javascript" src="obviel/obviel-template.js"></script>
    <script type="text/javascript" src="obviel/obviel.js"></script>
    <script type="text/javascript" src="handlebars.js"></script>
    <script type="text/javascript" src="pccc-ak-async-post.js"></script>
    <script type="text/javascript" src="humane.js"></script>
    <script type="text/javascript" src="opendebate.js"></script>

    <script type="text/javascript">
      function recognized_user_callback(valid, user) {
        if( !valid ) {
          $("#new_question input.user").val("");
        } else {
          $.each(["first_name", "last_name", "email", "zip"], function(i, n) {
            $("#new_question input[name=" + n + "]").val(user[n]);
          });
        } 
      };

  function fetch_and_validate_question() {

    $("#add_question_error").slideUp();
    $("#add_question_error .empty_input, #add_question_error .invalid_email, #add_question_error .invalid_zip").fadeOut();
    $("input.error, textarea.error, select.error").removeClass("error");

    var data = {};
    var empty = 0;
    
    $("#new_question input, #new_question textarea, #new_question select").each(
      function() {
    	if( $(this).hasClass("required") ) {
      	  if( $(this).val() === "" ) {
            $(this).addClass("error");
            empty++;
          }
        } 
    });
    if( $("#category").val() === "_other" && !($("#other_category").val()) ) {
      $("#other_category").addClass("error"); empty++;
    }
    //handle all possible errors
    
    if( empty > 0 || !validators.email($("#email").val()) || !validators.zip($("#zip").val())) {
    
      if( empty > 0 ){	
    		$("#add_question_error .empty_input").fadeIn();
      }
      
      if(!validators.email($("#email").val())){
      	   $("#email").addClass("error");
		   $("#add_question_error .invalid_email").fadeIn();
	  }
	   
	  if(!validators.zip($("#zip").val())){
	  	   $("#zip").addClass("error");
		   $("#add_question_error .invalid_zip").fadeIn();
	  }

      
      $("#add_question_error").slideDown();
  
	  return false;
    
    }
    
    data.first_name = $("#first_name").val();
    data.last_name = $("#last_name").val();
    data.email = $("#email").val();
    data.zip = $("#zip").val();
 
    var category = $("#category").val();
    if( category === "_other" ) {
      category = $("#other_category").val();
    }
    data.action_question_category = category;


    data.action_submission = $("#new_question_text").val();
    return data;
  };

  function question_submitted_callback(result, data) {
      
      $("#thanks").slideUp();
      $("thanks").remove("p");
      $("div.count span.count").text("200").removeClass("count_warning");
      
      if( result == "success" ) {
        
        $("input.error, textarea.error").removeClass("error");




        $("#new_question input, #new_question textarea").val("");
        //$("#thanks").html('<p>Thanks for adding your question! See it <a href="'+window.location.pathname+'#/question/'+data.question_id+'/">here</a>!  Want to submit another?</p>');
      	//$("#thanks").slideDown();
      	$(".lightbox.share_after_question").fadeIn();
          $("#overlay").fadeIn();
      } else {
        
        $.each(data, function(key, val) {
			$("#"+key).addClass('error');
		});
        
        $("#add_question_error .invalid").fadeIn();
		$("#add_question_error").slideDown();
      }
  };

     
      function vote_submitted_callback(result, data) {
		
        $("#verify_location_error input.error").removeClass("error");
        
        if( result == "success" ) {
            $("#vote_form_lightbox").fadeOut();

              if( opendebate.votes_this_session === 3 && 
                  !$.cookie("pccc.donate-lb") ) {
                      $(".lightbox.donate").fadeIn();
                      $("#overlay").fadeIn();
                      $.cookie("pccc.donate-lb", "yes", {expires: 7, path: "/"});
              } else {
                $("#overlay").fadeOut();
              }
        } else {
          $.each(data, function(key, val) {
            
            if(key != "zip:not_targeted"){
            	$('#vote_'+key).addClass("error");
            	$('.invalid_vote_'+key).fadeIn();
            } else {
                $("#vote_form_lightbox").fadeOut();
                $("#overlay").fadeIn();
 	        $('.out_of_area').fadeIn();
	    }
			
	  });
 	$("#verify_location_error").slideDown();
        }
      }

      function vote_user_data_fetcher(question_id) {
        
        $("#verify_location_error .error").removeClass("error");
        var empty = 0;
    
        $("#vote_form input").each(function() {
    	
    	  if( $(this).val() === "" ) {
            $(this).addClass("error");
	    empty++;
	  }
        });
        //handle all possible errors
    
        if( empty > 0 || !validators.email($("#vote_email").val()) || !validators.zip($("#vote_zip").val())) {
    
          if( empty > 0 ){	
    	    $("#verify_location_error .empty_input").fadeIn();
    	    $("#verify_location_error").slideDown();
    	    return false;
          }
      
          if(!validators.email($("#vote_email").val())){
      	    $("#vote_email").addClass("error");
	    $("#verify_location_error .invalid_vote_email").fadeIn();
	  }
	   
	  if(!validators.zip($("#vote_zip").val())){
	  	   $("#vote_zip").addClass("error");
		   $("#verify_location_error .invalid_vote_zip").fadeIn();
	  }

        
          $("#verify_location_error").slideDown();
	  return false;
	}
       
        
        data = {};
        data.email = $("#vote_email").val();
    	data.zip =  $("#vote_zip").val();
        return data;
      }

      function already_voted_callback(question_id, votes) {
        $(".already_voted").fadeIn();
        $("#overlay").fadeIn();
      }

      $("#new_question textarea").on("keyup", function() {
        var text = $(this).val();
        var length = 200 - text.length;
        $("div.count span.count").text(length);
        if( length < 0 ) {
          $("div.count span.count").addClass("count_warning");
        }
      });

      $(window).load(function() {

        $("#category").change(function() {
          var val = $(this).val();
          if( val === "_other" ) {
                     $("#other_category").slideDown();
          } else {
                     $("#other_category").slideUp();                     
          } 
        });                     

        var source = getArgs().source;
        if( source ) {
          $.cookie("pccc.source", source, {expires: 1, path: "/"});
        } 
        var akid = getArgs().akid;
        if( akid ) {
          $.cookie("pccc.akid", akid, {expires: 7, path: "/"});
        } 

        var sort = getArgs().sort;
        if( sort ) {
          window.location = window.location.pathname + "#/sort/" + sort + "/";
        }                     
        var qid = getArgs().question;
        if( qid ) {
          window.location = window.location.pathname + "#/question/" + qid + "/";
        }                     

        $.ajaxSetup({cache: false});
        opendebate.init(
                     "opendebate_questions_nyc",
                     "opendebate_vote_nyc",
                     "http://boldprogressives.github.io/nycdebate-data/questions.js", 
                     "http://boldprogressives.github.io/nycdebate-data/timeline.js", 
                     recognized_user_callback, 
                     fetch_and_validate_question, 
                     question_submitted_callback, 
                     vote_user_data_fetcher, 
                     vote_submitted_callback, 
                     already_voted_callback);

        $.fn.tagcloud.defaults = {
          size: {start: 8, end: 26, unit: 'pt'},
          color: {start: '#cde', end: '#f52'}
        };
        window.populateCategories = function(cats) {
          $("script.jsonp").remove();
          $("#category option:not(.fixed)").remove();
          for( var i=0; i<cats.length; ++i ) {
            $("<option>").attr("value", cats[i].name).text(cats[i].name + " (" + cats[i].num + ")").insertBefore("#category option.last");
            $("<a>").attr("rel", cats[i].num).css("color", "white").css("font-weight", "bold")
                                       .attr("data-category", cats[i].name)
                                       .css("padding", "0 2px")
                                       .attr("href", "#/category/" + cats[i].name + "/").text(cats[i].name).appendTo(".category-well div");
          }
          $(".category-well div a").tagcloud();
        };
       $("<script>").attr("type", "text/javascript").attr("class", "jsonp")
          .attr("src", "http://boldprogressives.github.io/nycdebate-data/categories.js")
          .appendTo("body");
     
     	$(document).on("click", ".vote-button", function(){
          
          var question_id = $(this).data("question_id");
          if( opendebate.akid || opendebate.recognized_user ) {
            opendebate.vote(question_id);
            return false;
          }
          
          var submit_function = 'opendebate.vote('+question_id+');' + 
                                ' return false;';
     	  $("#vote_form").attr("onsubmit", submit_function);
     	  $("#overlay").fadeIn();
     	  $("#vote_form_lightbox").fadeIn();
     	  return false;
     	});
     	
     	/* Close any lightbox by clicking X */
	$(document).on('click', '.close_box', function(){
			$(this).parent('.lightbox').fadeOut();
			$('.active').removeClass("active");
			$('#overlay').fadeOut();
	});
	
     
     $(document).keyup(function(e) { 
        			if (e.keyCode == 27) { // esc keycode
        				$('.active').removeClass("active");
           				$('.lightbox').fadeOut();
          				$('#overlay').fadeOut();
	          		}   			
       			});
       		

       		$(document).on("click", "#overlay", function(){
        			$(".lightbox").fadeOut();
        			$(this).fadeOut();
    			   			    
    			});
     
      });
    </script>


</body>
</html>
